[{"pageNumber":1,"pageContent":"packetlife.net by Jeremy Stretch v2.1-r1 BGP · P ART 1 Type About BGP eBGP AD iBGP AD Path Vector 20 200 Standard Protocols Transport Authentication RFC 4271 IP TCP/179 MD5 Path Selection Attribute Weight Administrative preference Description 1 Preference Highest Local Preference Communicated between peers within an AS 2 Highest Self-originated Prefer paths originated locally 3 True AS Path Minimize AS hops 4 Shortest Origin Prefer IGP-learned routes over EGP, and EGP over unknown 5 IGP MED Used externally to enter an AS 6 Lowest External Prefer eBGP routes over iBGP 7 eBGP IGP Cost Consider IGP metric 8 Lowest eBGP Peering Favor more stable routes 9 Oldest Router ID Tie breaker 10 Lowest Influencing Path Selection Weight neighbor 172.16.0.1 weight 200 MED default-metric 400 Local Preference bgp default local-preference 100 Route Map neighbor 172.16.0.1 route-map Foo Terminology Autonomous System (AS) A logical domain under the control of a single entity External BGP (eBGP) BGP adjacencies which span autonomous system boundaries Internal BGP (iBGP) BGP adjacencies formed within a single AS Synchronization Requirement A route must be known by an IGP before it may be advertised to BGP peers Packet Types Open Update Keepalive Notification Neighbor States Idle · Neighbor is not responding Connect · TCP session established Open Sent · Open message sent Open Confirm · Response received Established · Adjacency established Troubleshooting show ip bgp [summary] show ip bgp neighbors show ip route [bgp] clear ip bgp * [soft] debug ip bgp [...] Active · Attempting to connect Well-known Mandatory · Must be supported and propagated Well-known Discretionary · Must be supported; propagation optional Optional Transitive · Marked as partial if unsupported by neighbor Optional Nontransitive · Deleted if unsupported by neighbor Attributes Aggregator 7 ID and AS of summarizing router List of autonomous systems which the advertisement has traversed AS Path 2 Atomic Aggregate 6 Includes ASes which have been dropped due to route aggregation Originating cluster 13 Cluster ID Route tag 8 Community Metric for internal neighbors to reach external destinations (default 100) Local Preference 5 Multiple Exit Discriminator (MED) 4 Metric for external neighbors to reach the local AS (default 0) External peer in neighboring AS 3 Next Hop Origin type (IGP, EGP, or unknown) 1 Origin The originator of a reflected route 9 Originator ID Weight -- Cisco proprietary, not communicated to peers (default 0) Name Description List of cluster IDs 10 Cluster List Ignore AS Path bgp bestpath as-path ignore Ignore Cost Communities bgp bestpath cost-community ignore"},{"pageNumber":2,"pageContent":"packetlife.net by Jeremy Stretch v2.1-r1 BGP · P ART 2 Configuration Example interface Serial1/0 description Backbone to B ip address 172.16.0.1 255.255.255.252 ! interface Serial1/1 description Backbone to C ip address 172.16.0.5 255.255.255.252 ! interface FastEthernet2/0 description LAN ip address 192.168.1.1 255.255.255.0 ! router bgp 65100 no synchronization network 172.16.0.0 mask 255.255.255.252 network 172.16.0.4 mask 255.255.255.252 network 192.168.1.0 neighbor South peer-group neighbor South remote-as 65200 neighbor 172.16.0.2 peer-group South neighbor 172.16.0.6 peer-group South no auto-summary 10.0.0.0/30 172.16.0.0/30 172.16.0.4/30 AS 65100 AS 65200 F0/0 F0/0 A B C OSPF F2/0 F2/0 S1/0 S1/0 S1/0 S1/1 F2/0 interface FastEthernet0/0 description Backbone to B ip address 10.0.0.2 255.255.255.252 ! interface Serial1/0 description Backbone to A ip address 172.16.0.6 255.255.255.252 ! interface FastEthernet2/0 description LAN ip address 192.168.3.1 255.255.255.0 ! router ospf 100 network 10.0.0.2 0.0.0.0 area 0 network 192.168.3.1 0.0.0.0 area 2 ! router bgp 65200 no synchronization redistribute ospf 100 route-map LAN_Subnets neighbor 10.0.0.1 remote-as 65200 neighbor 172.16.0.5 remote-as 65100 no auto-summary ! access-list 10 permit 192.168.0.0 0.0.255.255 ! route-map LAN_Subnets permit 10 match ip address 10 set metric 100 interface FastEthernet0/0 description Backbone to C ip address 10.0.0.1 255.255.255.252 ! interface Serial1/0 description Backbone to A ip address 172.16.0.2 255.255.255.252 ! interface FastEthernet2/0 description LAN ip address 192.168.2.1 255.255.255.0 ! router ospf 100 network 10.0.0.1 0.0.0.0 area 0 network 192.168.2.1 0.0.0.0 area 1 ! router bgp 65200 no synchronization redistribute ospf 100 route-map LAN_Subnets neighbor 10.0.0.2 remote-as 65200 neighbor 172.16.0.1 remote-as 65100 no auto-summary ! access-list 10 permit 192.168.0.0 0.0.255.255 ! route-map LAN_Subnets permit 10 match ip address 10 set metric 100 Router A Routing Table Router B Routing Table 172.16.0.0/30 is subnetted, 2 subnets C 172.16.0.4 is directly connected, S1/1 C 172.16.0.0 is directly connected, S1/0 C 192.168.1.0/24 is directly connected, F2/0 B 192.168.2.0/24 [20/100] via 172.16.0.2 B 192.168.3.0/24 [20/100] via 172.16.0.2 172.16.0.0/30 is subnetted, 2 subnets B 172.16.0.4 [20/0] via 172.16.0.1 C 172.16.0.0 is directly connected, S1/0 10.0.0.0/30 is subnetted, 1 subnets C 10.0.0.0 is directly connected, F0/0 B 192.168.1.0/24 [20/0] via 172.16.0.1 C 192.168.2.0/24 is directly connected, F2/0 O IA 192.168.3.0/24 [110/2] via 10.0.0.2, F0/0 Router A Router C Router B"}]
