[{"pageNumber":1,"pageContent":"packetlife.net by Jeremy Stretch v2.0 F RAME M ODE MPLS Protocol Header MPLS Configuration ! Enable CEF ip cef ! Select label protocol mpls label protocol ldp ! Enable MPLS on IP interfaces interface FastEthernet0/0 ip address 10.0.0.1 255.255.255.252 mpls ip ! Raise MPLS MTU to accommodate multilabel stack mpls mtu 1512 Terminology Tag Distribution Protocol (TDP) Cisco's proprietary predecessor to LDP Label Distribution Protocol (LDP) Standards-based label distribution protocol defined in RFC 3036 Interim Packet Propagation An LSR temporarily falls back to IP routing while waiting to learn the necessary MPLS label(s) Label-Switched Path (LSP) The unidirectional path through one or more LSRs taken by a label-switched packet belonging to an FEC Forwarding Equivalence Class (FEC) A group of packets which are forwarded in an identical manner, typically by destination prefix and/or traffic class Troubleshooting show mpls interfaces show mpls ldp neighbors show mpls ldp bindings [detail] (LIB) show mpls forwarding-table [detail] (LFIB) show ip cef [detail] (FIB) Label (20 bits) · Unique label value Bottom of Stack (1 bit) · Indicates label is last in the stack Time To Live (8 bits) · Hop counter mapped from IP TTL Traffic Class (3 bits) · CoS-mapped QoS marking Label 8 16 24 32 TC S TTL L2 IP Label stack Label Switched Path Customer (C) · IP-only routers internal to customer network Provider Edge (PE) · LSRs on the MPLS-IP boundary Provider (P) · MPLS-only LSRs in provider network Customer Edge (CE) · C routers which face PE routers Label Protocols LDP UDP/646 Hello Port 224.0.0.2 Hello Address Proprietary Adjacency Port No TCP/646 PE PE LSP Provider Network Customer Network P P P CE CE C C TDP UDP/711 255.255.255.255 Cisco TCP/711 Conceptual Components Forwarding/Data Plane Forwards packets based on label or destination IP address (includes the FIB and LFIB) Control Plane Facilitates label exchange between neighboring LSRs using LDP or TDP (includes the LIB) Label Switching Router (LSR) Any router performing label switching (MPLS) Label Information Base (LIB) Contains all labels learned by an LSR via a label distribution protocol Forwarding Information Base (FIB) Routing database for unlabeled (IP) packets Label FIB (LFIB) Routing database for labeled (MPLS) packets Penultimate Hop Popping (PHP) The second-to-last LSR in an LSP removes the MPLS label so the last LSR only has to perform an IP lookup debug mpls [...]"}]
